// implement local loop with rollback and throttle window with `Agent`